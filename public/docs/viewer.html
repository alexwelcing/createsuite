<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CreateSuite Docs Viewer</title>
  <style>
    :root {
      color-scheme: dark;
    }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #0b1120;
      color: #e2e8f0;
      line-height: 1.7;
    }
    header {
      background: #111827;
      border-bottom: 1px solid #1f2937;
      padding: 20px 24px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 12px;
    }
    header a {
      color: #93c5fd;
      text-decoration: none;
      font-weight: 600;
    }
    header a:hover {
      text-decoration: underline;
    }
    header span {
      color: #94a3b8;
    }
    main {
      max-width: 980px;
      margin: 0 auto;
      padding: 32px 24px 64px;
    }
    .title {
      font-size: 1.8rem;
      margin: 0 0 12px;
      color: #38bdf8;
    }
    pre {
      background: #0f172a;
      border: 1px solid #1e293b;
      border-radius: 12px;
      padding: 20px;
      overflow-x: auto;
    }
    code {
      font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
      font-size: 0.95rem;
    }
    .error {
      color: #fca5a5;
      background: #1f2937;
      border: 1px solid #374151;
      padding: 16px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <header>
    <a href="./index.html">← Back to Docs</a>
    <span id="file-name">Loading…</span>
  </header>
  <main>
    <h1 class="title" id="doc-title">Documentation</h1>
    <pre><code id="doc-content">Loading documentation…</code></pre>
    <div class="error" id="doc-error" hidden></div>
  </main>
  <script>
    const fileParam = new URLSearchParams(window.location.search).get("file");
    const decodedFileName = fileParam ? decodeURIComponent(fileParam) : "";
    const fileLabel = document.getElementById("file-name");
    const title = document.getElementById("doc-title");
    const content = document.getElementById("doc-content");
    const errorBox = document.getElementById("doc-error");

    if (
      !decodedFileName
      || decodedFileName.startsWith("/")
      || decodedFileName.split("/").includes("..")
      || !/^[a-zA-Z0-9._/-]+$/.test(decodedFileName)
    ) {
      errorBox.textContent = "Invalid documentation path.";
      errorBox.hidden = false;
      content.textContent = "";
      fileLabel.textContent = "";
    } else {
      fileLabel.textContent = decodedFileName;
      title.textContent = decodedFileName.split("/").pop();
      fetch(`./${decodedFileName}`)
        .then((response) => {
          if (!response.ok) {
            throw new Error("Unable to load the selected document.");
          }
          return response.text();
        })
        .then((text) => {
          content.textContent = text;
        })
        .catch(() => {
          errorBox.textContent = "Unable to load the selected document.";
          errorBox.hidden = false;
          content.textContent = "";
        });
    }
  </script>
</body>
</html>
